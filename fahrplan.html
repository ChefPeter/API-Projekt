<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fahrplan</title>
    <link rel="stylesheet" href="fahrplan.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="fahrplan.js"></script>
    <link rel="shortcut icon" href="bus.png" type="image/x-icon">
</head>

<body>
    <div id="fahrplan">
        <div style="display: flex;">

            <div id="abfahrt">
                <h1 style="font-weight: bold;">Haltestelle: Dantestra√üe Brixen</h1>
            </div>   
            <div id="datum">
                <span id='zeit'></span>
            </div>

        </div>         

        <div id="formatierung">
            <table class="table table-striped" style="max-width: 70%; min-width: 70%;">
                <tr>
                    <th>Linie</th>
                    <th>Ziel</th>
                    <th>Abfahrt</th>
                    <th></th>
                </tr>
                <tr>
                    <th id="linie0"></th>
                    <th id="ziel0"></th>
                    <th id="abfahrt0"></th>
                    <th id="countdown0"></th>
                </tr>
                <tr>
                    <th id="linie1"></th>
                    <th id="ziel1"></th>
                    <th id="abfahrt1"></th>
                    <th id="countdown1"></th>
                </tr>
                <tr>
                    <th id="linie2"></th>
                    <th id="ziel2"></th>
                    <th id="abfahrt2"></th>
                    <th id="countdown2"></th>
                </tr>
                <tr>
                    <th id="linie3"></th>
                    <th id="ziel3"></th>
                    <th id="abfahrt3"></th>
                    <th id="countdown3"></th>
                </tr>
                <tr>
                    <th id="linie4"></th>
                    <th id="ziel4"></th>
                    <th id="abfahrt4"></th>
                    <th id="countdown4"></th>
                </tr>
                <tr>
                    <th id="linie5"></th>
                    <th id="ziel5"></th>
                    <th id="abfahrt5"></th>
                    <th id="countdown5"></th>
                </tr>
                <tr>
                    <th id="linie6"></th>
                    <th id="ziel6"></th>
                    <th id="abfahrt6"></th>
                    <th id="countdown6"></th>
                </tr>
                <tr>
                    <th id="linie7"></th>
                    <th id="ziel7"></th>
                    <th id="abfahrt7"></th>
                    <th id="countdown7"></th>
                </tr>
                <tr>
                    <th id="linie8"></th>
                    <th id="ziel8"></th>
                    <th id="abfahrt8"></th>
                    <th id="countdown8"></th>
                </tr>
                <tr>
                    <th id="linie9"></th>
                    <th id="ziel9"></th>
                    <th id="abfahrt9"></th>
                    <th id="countdown9"></th>
                </tr>
                <tr>
                    <th id="linie10"></th>
                    <th id="ziel10"></th>
                    <th id="abfahrt10"></th>
                    <th id="countdown10"></th>
                </tr>
                <tr>
                    <th id="linie11"></th>
                    <th id="ziel11"></th>
                    <th id="abfahrt11"></th>
                    <th id="countdown11"></th>
                </tr>
                <tr>
                    <th id="linie12"></th>
                    <th id="ziel12"></th>
                    <th id="abfahrt12"></th>
                    <th id="countdown12"></th>
                </tr>
                <tr>
                    <th id="linie13"></th>
                    <th id="ziel13"></th>
                    <th id="abfahrt13"></th>
                    <th id="countdown13"></th>
                </tr>
               
            </table>
            <div>
                <div class="rand">
                    <h4 style="color: rgb(13, 122, 172);">
                        Wetter Brixen
                    </h4>
                    <div>
                        <img src="./Wetter/grad.png" alt="" class="bilder">
                        <br>
                        <img src="./Wetter/niederschlag.png" alt="" class="bilder">
                        <br>
                        <img src="./Wetter/wind.png" alt="" class="bilder">
                    </div>
                </div>
                    
                <div class="rand" style="margin-top: 30px;">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque, tempora? Laboriosam, eveniet nemo. Velit dolore officia neque quidem voluptatum, quibusdam consequatur hic ad, quos est, ab atque cum. Modi, assumenda?</p>
                </div>
                <button type="button" onclick="einlesen()">Test</button>
            </div>
       
        </div>
 
    </div>

    <script>
        function einlesen(){
            //console.log("Test");
            fetch("https://efa.sta.bz.it/apb/XML_DM_REQUEST?&locationServerActive=1&stateless=1&type_dm=any&name_dm=Brixen%20Brixen%20Dantestra%C3%9Fe&mode=direct&outputFormat=json")
                .then(response => response.json())
                .then(json => kontrolle(json));
        }

        function kontrolle(data){

            let linieId = "";
            let zielId = "";
            let abfahrtId = "";
            let minu = 0;

            for(let i=0; i<14; i++){
                //console.log(data.departureList[i].servingLine.direction);
                linieId = "linie" + i;
                zielId = "ziel" + i;
                abfahrtId = "abfahrt" + i;
                minu = data.departureList[i].dateTime.minute;

                document.getElementById(linieId).innerHTML = data.departureList[i].servingLine.number;
                document.getElementById(zielId).innerHTML = data.departureList[i].servingLine.direction;
                if (minu<10) document.getElementById(abfahrtId).innerHTML = data.departureList[i].dateTime.hour + ":0" + minu;
                else document.getElementById(abfahrtId).innerHTML = data.departureList[i].dateTime.hour + ":" + minu;
            
            }
        }
    </script>
</body>
</html>